<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
</head>
<body>
  <h1>Dashboard</h1>
  <h2>Info</h2>
  Your token: <%= user.token %> <br/>
  This month calls: 1223<br/>
  Expected bill: $1.2<br/>
  Card number: ***4533
  <h3>update info</h3>

  <form id="payment-form" onsubmit="return onUpdateCard(this);">
    <span class="payment-errors"></span>

    <div class="form-row">
      <label>
        <span>Card Number</span>
        <input type="text" size="20" data-stripe="number"/>
      </label>
    </div>

    <div class="form-row">
      <label>
        <span>CVC</span>
        <input type="text" size="4" data-stripe="cvc"/>
      </label>
    </div>

    <div class="form-row">
      <label>
        <span>Expiration (MM/YYYY)</span>
        <input type="text" size="2" data-stripe="exp-month"/>
      </label>
      <span> / </span>
      <input type="text" size="4" data-stripe="exp-year"/>
    </div>

    <button type="submit">Submit Payment</button>
  </form>


  <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
  <script type="text/javascript">
    Stripe.setPublishableKey('pk_test_QNbEPeTckhQCMGiR0HkYZR8x');

    function onUpdateCard(form){
      Stripe.card.createToken(form, stripeResponseHandler);
      return false;
    }

    function stripeResponseHandler(status, response) {
      console.log(status, response);
      if (response.error) {
      } else {
        var token = response.id;
      }
    };
  </script>
</body>
</html>